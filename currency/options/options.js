Options={data:localStorage.data?JSON.parse(localStorage.data):{currency:'EUR',icon:!0},port:chrome.runtime.connect({name:'htmlConverter'}),initialize:function(){var a=document.getElementById('icon'),b=document.getElementById('format-position'),c=document.getElementById('format-decimal'),d=document.getElementById('currency'),e=['<optgroup label="Major currencies">'],f=0;for(var g in currencies)4==f++&&e.push('</optgroup><optgroup label="More currencies">'),e.push('<option '+(g==this.data.currency?'selected class="selected"':'')+' value="'+g+'">'+g+' - '+currencies[g]+'</option>');e.push('</optgroup>'),d.innerHTML=e.join('\n'),this.data.formatPosition&&this.select('format-position',this.data.formatPosition),this.data.formatDecimal&&this.select('format-decimal',this.data.formatDecimal),this.data.round&&this.select('round',this.data.round)},save:function(){var a=document.getElementById('currency'),b=a.selectedIndex;a.querySelector('.selected')&&(a.querySelector('.selected').className=''),a.options[b].className='selected';var c=a.value;this.data=localStorage.data?JSON.parse(localStorage.data):this.data,this.data.currency=c,this.data.formatDecimal=document.getElementById('format-decimal').value,this.data.formatPosition=document.getElementById('format-position').value,delete this.data.rates,localStorage.data=JSON.stringify(this.data);var d=document.getElementById('say');d.innerHTML='Saved',d.style.display='inline',setTimeout(function(){d.style.display='none'},1500),Options.port.postMessage({update:!0})},select:function(a,b){var c=document.getElementById(a);Array.prototype.slice.call(c.options).forEach(function(a,d){a.value==b&&(c.selectedIndex=d)})}},window.onload=function(){Options.initialize()},document.querySelector('button').addEventListener('click',function(){Options.save()},!1);